<!DOCTYPE html>
<html lang="es" data-theme="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard | Gesti칩n de Fletes</title>

    <!-- 游꿛 Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">

    <!-- 游늵 Librer칤as Externas -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>

    <link rel="stylesheet" href="styles.css">
    <script src="app.js" defer></script>
</head>

<body>

    <!-- 游릭 SIDEBAR (Navegaci칩n) -->
    <aside class="sidebar glass-sidebar">
        <div class="logo-container">
            <img src="logo_tym.png" alt="Logo Empresa" class="logo-img">
            <h2 class="brand-name">FletesApp</h2>
        </div>

        <nav class="nav-links">
            <a class="nav-item active" data-tab="inicio">
                <i class="ri-home-4-line"></i> Inicio
            </a>
            <a class="nav-item" data-tab="fletes">
                <i class="ri-file-list-3-line"></i> Gesti칩n Fletes
            </a>
            <a class="nav-item" data-tab="estadisticas" id="btnEstadisticas">
                <i class="ri-pie-chart-2-line"></i> Estad칤sticas
            </a>
        </nav>

        <div class="sidebar-footer">
            <div class="actions">
                <button onclick="exportarExcel()" class="action-btn" title="Exportar Excel">
                    <i class="ri-file-excel-2-line"></i>
                </button>
                <button onclick="generarPDFReporte()" class="action-btn" title="Generar PDF">
                    <i class="ri-file-pdf-2-line"></i>
                </button>
            </div>

            <div class="theme-switch-wrapper">
                <label class="theme-switch" for="themeToggle">
                    <input type="checkbox" id="themeToggle" />
                    <div class="slider round">
                        <i class="ri-sun-line sun-icon"></i>
                        <i class="ri-moon-line moon-icon"></i>
                    </div>
                </label>
            </div>

            <a class="logout-btn" href="index.html" onclick="logout()">
                <i class="ri-logout-box-r-line"></i> Salir
            </a>
        </div>
    </aside>

    <!-- 游댯 MAIN CONTENT -->
    <main class="main-content">

        <!-- HEADER M칍VIL / TOPBAR -->
        <header class="topbar glass-header">
            <button id="menuToggleBtn" class="menu-btn"><i class="ri-menu-2-line"></i></button>
            <h1 id="pageTitle">Dashboard General</h1>
            <div class="user-profile">
                <span class="badget" id="userRoleBadge">Admin</span>
                <div class="avatar">
                    <i class="ri-user-3-line"></i>
                </div>
            </div>
        </header>

        <!-- 游 SECCI칍N INICIO -->
        <section id="inicio" class="tab-content visible fade-in">
            <div class="kpi-grid">
                <div class="card glass-card kpi-card">
                    <div class="kpi-icon"><i class="ri-truck-line"></i></div>
                    <div class="kpi-info">
                        <h3>Total Fletes</h3>
                        <p id="cantFletes" class="kpi-value">0</p>
                    </div>
                </div>
                <!-- Se pueden agregar m치s KPIs aqu칤 -->
            </div>
        </section>

        <!-- 游닇 SECCI칍N GESTI칍N FLETES -->
        <section id="fletes" class="tab-content fade-in">

            <!-- FORMULARIO DE REGISTRO -->
            <div class="card glass-card">
                <div class="card-header">
                    <h2><i class="ri-add-circle-line"></i> Registrar Nuevo Flete</h2>
                </div>
                <div class="card-body">
                    <div class="form-grid">
                        <div class="input-group">
                            <label>Placa Veh칤culo</label>
                            <input id="placa" placeholder="EJ: ABC-123" oninput="this.value = this.value.toUpperCase()">
                        </div>
                        <div class="input-group">
                            <label>Conductor (Auto)</label>
                            <input id="Contratista" placeholder="Nombre Conductor" readonly class="input-readonly">
                        </div>

                        <div class="input-group">
                            <label>Zona</label>
                            <select id="zona">
                                <option value="" disabled selected>Seleccione...</option>
                                <option>Zona Norte</option>
                                <option>Zona Sur</option>
                                <option>Zona Oriente</option>
                                <option>Zona Occidente</option>
                                <option>Nacional</option>
                            </select>
                        </div>

                        <div class="input-group">
                            <label>D칤a</label>
                            <select id="D칤a">
                                <option value="" disabled selected>Seleccione...</option>
                                <option>Lunes</option>
                                <option>Martes</option>
                                <option>Miercoles</option>
                                <option>Jueves</option>
                                <option>Viernes</option>
                                <option>Sabado</option>
                            </select>
                        </div>

                        <div class="input-group">
                            <label>Poblaci칩n</label>
                            <select id="Poblac칤on">
                                <option value="" disabled selected>Seleccione...</option>
                                <option>Pereira</option>
                                <option>Dosquebradas</option>
                                <option>Manizales</option>
                                <option>Armenia</option>
                                <option>Cartago</option>
                                <option>Cuba</option>
                                <option>Parque Industrial</option>
                                <option>Sta Rosa</option>
                                <option>Quimbaya</option>
                                <option>Viterbo</option>
                                <option>Vereda</option>
                            </select>
                        </div>

                        <div class="input-group">
                            <label>Nombres Auxiliares</label>
                            <input id="Auxiliares" type="text" placeholder="Separados por coma">
                        </div>

                        <div class="input-group">
                            <label>Cant. Auxiliares</label>
                            <select id="No. Auxiliares">
                                <option value="0">0</option>
                                <option>1</option>
                                <option>2</option>
                                <option>3</option>
                            </select>
                        </div>

                        <div class="input-group">
                            <label>No. Pedidos</label>
                            <input id="NoPedi" type="number" placeholder="0">
                        </div>

                        <div class="input-group">
                            <label>Valor Ruta (COP)</label>
                            <input id="Valor Ruta" type="text" placeholder="$ 0" class="money-input">
                        </div>

                        <div class="input-group">
                            <label>쮸dicionales?</label>
                            <select id="Adicionales?">
                                <option value="No">No</option>
                                <option value="Si">Si (+ $60.000)</option>
                            </select>
                        </div>

                        <div class="input-group full-width">
                            <label>Total Flete (Automatico)</label>
                            <input id="totalflete" type="text" placeholder="$ 0" readonly class="input-total">
                        </div>
                    </div>

                    <div class="form-actions">
                        <button id="btnGestionarFlete" class="btn btn-primary btn-glow" onclick="crearFlete()">
                            <i class="ri-save-3-line"></i> Guardar Flete
                        </button>
                    </div>
                </div>
            </div>

            <!-- TABLA Y FILTROS -->
            <div class="card glass-card">
                <div class="card-header flex-header">
                    <h2><i class="ri-search-eye-line"></i> Buscar Fletes</h2>
                    <div class="filters">
                        <input id="buscarFlete" placeholder="Buscar placa o conductor..." onkeyup="buscarFletes()">
                        <select id="filtroZona" onchange="buscarFletes()">
                            <option value="">Todas las Zonas</option>
                            <option>Zona Norte</option>
                            <option>Zona Sur</option>
                            <option>Zona Oriente</option>
                            <option>Zona Occidente</option>
                            <option>Nacional</option>
                        </select>
                        <input type="date" id="filtroFecha" onchange="buscarFletes()">
                    </div>
                </div>

                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Fecha</th>
                                <th>Conductor</th>
                                <th>Placa</th>
                                <th>Zona</th>
                                <th>Precio Final</th>
                                <th class="actions-col">Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="tablaFletes">
                            <!-- JS Renders Rows Here -->
                        </tbody>
                    </table>
                </div>
            </div>

        </section>

        <!-- 游늵 SECCI칍N ESTAD칈STICAS -->
        <section id="estadisticas" class="tab-content fade-in">
            <div class="grid-2">
                <div class="card glass-card chart-container">
                    <h3>Ingresos por Mes</h3>
                    <div class="chart-wrapper">
                        <canvas id="chartIngresos"></canvas>
                    </div>
                </div>
                <div class="card glass-card chart-container">
                    <h3>Fletes por Zona</h3>
                    <div class="chart-wrapper">
                        <canvas id="chartZonas"></canvas>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- MODAL EDICI칍N -->
    <div id="modalEdicionFlete" class="modal-overlay">
        <div class="modal-glass">
            <div class="modal-header">
                <h2>九勇 Editar Flete</h2>
                <button class="close-btn" onclick="ocultarModalEdicion()"><i class="ri-close-line"></i></button>
            </div>

            <div class="modal-body">
                <div class="form-grid">
                    <!-- Mismos campos con prefijo modal- -->
                    <div class="input-group"> <label>Placa</label> <input id="modal-placa"
                            oninput="this.value = this.value.toUpperCase()"> </div>
                    <div class="input-group"> <label>Conductor</label> <input id="modal-Contratista" readonly
                            class="input-readonly"> </div>

                    <div class="input-group">
                        <label>Zona</label>
                        <select id="modal-zona">
                            <option>Zona Norte</option>
                            <option>Zona Sur</option>
                            <option>Zona Oriente</option>
                            <option>Zona Occidente</option>
                            <option>Nacional</option>
                        </select>
                    </div>

                    <div class="input-group"> <label>D칤a</label> <select id="modal-D칤a">
                            <option>Lunes</option>
                            <option>Martes</option>
                            <option>Miercoles</option>
                            <option>Jueves</option>
                            <option>Viernes</option>
                            <option>Sabado</option>
                        </select> </div>

                    <div class="input-group"> <label>Poblaci칩n</label> <select id="modal-Poblac칤on">
                            <option>Pereira</option>
                            <option>Dosquebradas</option>
                            <option>Manizales</option>
                            <option>Armenia</option>
                            <option>Cartago</option>
                            <option>Cuba</option>
                            <option>Parque Industrial</option>
                            <option>Sta Rosa</option>
                            <option>Quimbaya</option>
                            <option>Viterbo</option>
                            <option>Vereda</option>
                        </select> </div>

                    <div class="input-group"> <label>Auxiliares</label> <input id="modal-Auxiliares" type="text"> </div>
                    <div class="input-group"> <label>No. Aux</label> <select id="modal-No. Auxiliares">
                            <option>0</option>
                            <option>1</option>
                            <option>2</option>
                        </select> </div>
                    <div class="input-group"> <label>No. Pedidos</label> <input id="modal-NoPedi" type="number"> </div>

                    <div class="input-group"> <label>Valor Ruta</label> <input id="modal-Valor Ruta" type="text"
                            class="money-input"> </div>

                    <div class="input-group">
                        <label>쮸dicionales?</label>
                        <select id="modal-Adicionales?">
                            <option value="No">No</option>
                            <option value="Si">Si</option>
                        </select>
                    </div>

                    <div class="input-group full-width"> <label>Total</label> <input id="modal-totalflete" type="text"
                            readonly class="input-total"> </div>
                </div>
            </div>

            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="ocultarModalEdicion()">Cancelar</button>
                <button id="btnGuardarModal" class="btn btn-primary" onclick="guardarCambiosFlete()">Guardar
                    Cambios</button>
            </div>
        </div>
    </div>

</body>

</html>